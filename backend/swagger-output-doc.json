{
  "openapi": "3.0.0",
  "info": {
    "version": "1.0",
    "title": "SplitEase API",
    "description": "Description"
  },
  "host": "localhost:3000",
  "basePath": "/",
  "schemes": ["http"],
  "securityDefinitions": {
    "bearerAuth": {
      "type": "apiKey",
      "in": "header",
      "name": "Authorization",
      "description": "Bearer Token"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000/"
    }
  ],
  "paths": {
    "/api/1.0/": {
      "get": {
        "tags": ["Health Check API"],
        "summary": "An health check endpoint for AWS ELB",
        "description": "Always returns 200 OK",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/1.0/s3url": {
      "get": {
        "tags": ["Pre-signed S3 URL API"],
        "summary": "An endpoint for acquiring pre-signed S3 URL for uploading file",
        "description": "Response contains pre-signed S3 URL and file name",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "url": {
                      "type": "string",
                      "description": "Pre-signed S3 URL for uploading file",
                      "example": "https://your-bucket-name.s3.your-zone.amazonaws.com/7a3992dd952127fa33e43ac8e6b032a4?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAYQRXHFVMR3EMVBM7%2F20230516%2Fap-northeast-1%2Fs3%2Faws4_request&X-Amz-Date=20230516T122525Z&X-Amz-Expires=60&X-Amz-Signature=42a6b012aa430e30ba6a2f1c5f4644d7aba82a7f16758c1ae260216563e8f113&X-Amz-SignedHeaders=host&x-id=PutObject"
                    },
                    "imageName": {
                      "type": "string",
                      "description": "Pre-signed file name",
                      "example": "7a3992dd952127fa33e43ac8e6b032a4"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnauthorizedError"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForbiddenError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/S3URLError"
                }
              }
            }
          }
        }
      }
    },
    "/api/1.0/user/signup": {
      "post": {
        "tags": ["User API"],
        "summary": "An endpoint for signing up",
        "description": "Allow user to sign up with name, email and password",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "User name",
                    "example": "Test User"
                  },
                  "email": {
                    "type": "string",
                    "description": "User email",
                    "example": "test@test.com"
                  },
                  "password": {
                    "type": "string",
                    "description": "User password",
                    "example": "Test123!"
                  }
                },
                "required": ["name", "email", "password"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SignUp scucessful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginResponse"
                }
              }
            }
          },
          "403": {
            "description": "Email Already Exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailExistError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      }
    },
    "/api/1.0/user/signin": {
      "post": {
        "tags": ["User API"],
        "summary": "An endpoint for signing in",
        "description": "Allow user to sign in with email and password via native login or LINE login",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "description": "User email",
                    "example": "test@test.com"
                  },
                  "password": {
                    "type": "string",
                    "description": "User password",
                    "example": "Test123!"
                  }
                },
                "required": ["name", "email", "password"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SignIn scucessful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InvalidLoginError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      }
    },
    "/api/1.0/user/groups": {
      "get": {
        "tags": ["User API"],
        "summary": "An endpoint for getting user groups",
        "description": "Allow user to get all groups that user is in",
        "parameters": [
          {
            "name": "is_archived",
            "in": "query",
            "description": "Filter by archive status",
            "required": false,
            "schema": {
              "type": "integer",
              "enum": [0, 1]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "minItems": 0,
                  "maxItems": 100,
                  "items": {
                    "$ref": "#/components/schemas/Group"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnauthorizedError"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForbiddenError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      }
    },
    "/api/1.0/user/profile": {
      "get": {
        "tags": ["User API"],
        "summary": "An endpoint for getting user profile",
        "description": "Allow users to access their own profile",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Get Profile scucessful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthUser"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnauthorizedError"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForbiddenError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["User API"],
        "summary": "An endpoint for updating user profile",
        "description": "Allow users to modify their own profile",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "User name",
                    "example": "SplitEase"
                  },
                  "image": {
                    "type": "string",
                    "description": "User profile image URL",
                    "example": "https://you-cdn.cloudfront.net/you-image"
                  }
                },
                "required": ["name", "image"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SignIn scucessful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UpdateUserProfileResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnauthorizedError"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForbiddenError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      }
    },

    "/api/1.0/group": {
      "post": {
        "tags": ["Group API"],
        "summary": "An endpoint for creating group",
        "description": "Allow user to create group",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "owner": {
                    "type": "number",
                    "description": "Group Owner Id",
                    "example": 1
                  },
                  "name": {
                    "type": "string",
                    "description": "Group name",
                    "example": "SplitEase Test Group"
                  },
                  "default_currency": {
                    "type": "number",
                    "description": "Group default currency ID",
                    "example": 1
                  },
                  "description": {
                    "type": "string",
                    "description": "User email",
                    "example": "SplitEase Awesome"
                  }
                },
                "required": ["owner", "name", "default_currency", "description"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SignUp scucessful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NewGroup"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnauthorizedError"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForbiddenError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      }
    },
    "/api/1.0/group/{group_id}": {
      "get": {
        "tags": ["Group API"],
        "description": "",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnauthorizedError"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForbiddenError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Group API"],
        "description": "",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnauthorizedError"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForbiddenError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Group API"],
        "description": "",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnauthorizedError"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForbiddenError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      }
    },
    "/api/1.0/group/members/{group_id}": {
      "get": {
        "tags": ["Group API"],
        "description": "",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {}
      }
    },
    "/api/1.0/group/{slug}/join": {
      "get": {
        "tags": ["Group API"],
        "description": "",
        "parameters": [
          {
            "name": "slug",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {}
      },
      "post": {
        "tags": ["Group API"],
        "description": "",
        "parameters": [
          {
            "name": "slug",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      }
    },
    "/api/1.0/group/{group_id}/settle": {
      "post": {
        "tags": ["Group API"],
        "description": "",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnauthorizedError"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForbiddenError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      }
    },
    "/api/1.0/group/{group_id}/logs": {
      "get": {
        "tags": ["Group API"],
        "description": "",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnauthorizedError"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForbiddenError"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InternalServerError"
                }
              }
            }
          }
        }
      }
    },

    "/api/1.0/expense": {
      "get": {
        "tags": ["Expense API"],
        "description": "",
        "parameters": [],
        "responses": {
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      },
      "post": {
        "tags": ["Expense API"],
        "description": "",
        "parameters": [],
        "responses": {
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      },
      "put": {
        "tags": ["Expense API"],
        "description": "",
        "parameters": [],
        "responses": {
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      },
      "delete": {
        "tags": ["Expense API"],
        "description": "",
        "parameters": [],
        "responses": {
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      }
    },
    "/api/1.0/debts/{group_id}": {
      "get": {
        "tags": ["Debt API"],
        "description": "",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      },
      "post": {
        "tags": ["Debt API"],
        "description": "",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      }
    },
    "/api/1.0/debts/{group_id}/settling": {
      "get": {
        "tags": ["Debt API"],
        "description": "",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {}
      }
    },
    "/api/1.0/debts/{group_id}/notification": {
      "post": {
        "tags": ["Debt API"],
        "description": "",
        "parameters": [
          {
            "name": "group_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Forbidden"
          }
        }
      }
    }
  },

  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "UnauthorizedError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message",
            "example": "Unauthorized"
          }
        }
      },
      "ForbiddenError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message",
            "example": "Forbidden"
          }
        }
      },
      "S3URLError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message",
            "example": "AWS Error Message"
          }
        }
      },
      "InternalServerError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message",
            "example": "Server Error: Database Query Error"
          }
        }
      },
      "EmailExistError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message",
            "example": "Request Error: Email Already Exists"
          }
        }
      },
      "InvalidLoginError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message",
            "example": "Request Error: Invalid email or password"
          }
        }
      },
      "AuthUser": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 9527
          },
          "provider": {
            "type": "string",
            "example": "native"
          },
          "name": {
            "type": "string",
            "example": "Test User"
          },
          "email": {
            "type": "string",
            "example": "test@test.com"
          },
          "image": {
            "type": "string",
            "example": "https://your-cdn.cloudfront.net/user-image.jpg"
          },
          "line_binding_code": {
            "type": "string",
            "example": "QKqAe2D0xq"
          }
        }
      },
      "LoginResponse": {
        "type": "object",
        "properties": {
          "access_token": {
            "type": "string",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NjksInByb3ZpZGVyIjoibmF0aXZlIiwibmFtZSI6IkFzaGVseSIsImVtYWlsIjoiYXpvbGUxQGdtYWlsLmNvbSIsImltYWdlIjoiaHR0cHM6Ly9keGtnZmdnNzloM2h6LmNsb3VkZnJvbnQubmV0L2F2YXRhcnMva29hbGFfYXZhdGFyLmpwZyIsImxpbmVfYmluZGluZ19jb2RlIjoiUUtxYWUyRG94biIsImlhdCI6MTY4NDI0MjcxMCwiZXhwIjoxNjg0MzI5MTEwfQ.un7mK5KRl4TGXMMp8DbLetIy0aMcYxfxRTJww0g7Ia8"
          },
          "access_expired": {
            "type": "string",
            "example": "1d"
          },
          "login_at": {
            "type": "string",
            "example": "2023-12-31T00:00:00.000Z"
          },
          "user": {
            "$ref": "#/components/schemas/AuthUser"
          }
        }
      },
      "UpdateUserProfileResponse": {
        "type": "object",
        "properties": {
          "access_token": {
            "type": "string",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NjksInByb3ZpZGVyIjoibmF0aXZlIiwibmFtZSI6IkFzaGVseSIsImVtYWlsIjoiYXpvbGUxQGdtYWlsLmNvbSIsImltYWdlIjoiaHR0cHM6Ly9keGtnZmdnNzloM2h6LmNsb3VkZnJvbnQubmV0L2F2YXRhcnMva29hbGFfYXZhdGFyLmpwZyIsImxpbmVfYmluZGluZ19jb2RlIjoiUUtxYWUyRG94biIsImlhdCI6MTY4NDI0MjcxMCwiZXhwIjoxNjg0MzI5MTEwfQ.un7mK5KRl4TGXMMp8DbLetIy0aMcYxfxRTJww0g7Ia8"
          },
          "access_expired": {
            "type": "string",
            "example": "1d"
          },
          "user": {
            "$ref": "#/components/schemas/AuthUser"
          }
        }
      },
      "Group": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 1,
            "description": "Group ID"
          },
          "slug": {
            "type": "string",
            "example": "54e3d947-5a82-4b87-63f6-1140hdf2053d",
            "description": "Group slug"
          },
          "owner": {
            "type": "number",
            "example": 9527,
            "description": "User ID"
          },
          "name": {
            "type": "string",
            "example": "SplitEase Test Group",
            "description": "Group name"
          },
          "description": {
            "type": "string",
            "example": "SplitEase Awesome",
            "description": "Group description"
          },
          "default_currency": {
            "type": "number",
            "example": 1,
            "description": "Currency ID"
          },
          "minimized_debts": {
            "type": "string",
            "example": "0"
          },
          "photo": {
            "type": "string",
            "example": "https://your-cdn.cloudfront.net/group-photo.jpg"
          },
          "invitation_code": {
            "type": "string",
            "example": "pXeas1aqBg"
          },
          "creation_date": {
            "type": "string",
            "example": "2023-12-31T00:00:00.000Z"
          },
          "is_archived": {
            "type": "string",
            "example": "0"
          },
          "line_id": {
            "type": "string",
            "example": "LINE group id (default: null)"
          }
        }
      },
      "NewGroup": {
        "type": "object",
        "properties": {
          "id": {
            "type": "number",
            "example": 1,
            "description": "Group ID"
          },
          "slug": {
            "type": "string",
            "example": "54e3d947-5a82-4b87-63f6-1140hdf2053d",
            "description": "Group slug"
          },
          "owner": {
            "type": "number",
            "example": 9527,
            "description": "User ID"
          },
          "name": {
            "type": "string",
            "example": "SplitEase Test Group",
            "description": "Group name"
          },
          "description": {
            "type": "string",
            "example": "SplitEase Awesome",
            "description": "Group description"
          },
          "default_currency": {
            "type": "number",
            "example": 1,
            "description": "Currency ID"
          },
          "photo": {
            "type": "string",
            "example": "https://your-cdn.cloudfront.net/group-photo.jpg"
          }
        }
      }
    }
  }
}
